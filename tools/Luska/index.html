import React, { useState, useEffect } from 'react';  // --- Komponenty pre ikony (SVG) --- const CheckCircleIcon = ({ className }) => (   <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">     <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />   </svg> );  const ExclamationCircleIcon = ({ className }) => (     <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />     </svg> );  const ClipboardListIcon = ({ className }) => (   <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">     <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />   </svg> );  const BeakerIcon = ({ className }) => (     <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />     </svg> );   // --- Hlavná Aplikácia --- export default function App() {   const [step, setStep] = useState(1);   const [symptoms, setSymptoms] = useState({     hematuria: false,     pain: false,     proteinuria: false,     dyspareunia: false,     varicocele: false,     fatigue: false,   });   const [differential, setDifferential] = useState({     uti: false,     nephritis: false,     stones: false,     endometriosis: false,     autoimmune: false,   });   const [dusResults, setDusResults] = useState({ diameterRatio: '', velocityRatio: '', distance: '' });   const [ctaMraResults, setCtaMraResults] = useState({ compression: false, collaterals: false, gonadalDistension: false, angle: '' });   const [invasiveResults, setInvasiveResults] = useState({ gradient: '' });   const [diagnosis, setDiagnosis] = useState(null);    const symptomList = {     hematuria: 'Hematúria (mikroskopická alebo makroskopická)',     pain: 'Bolesť v boku, chrbte alebo panve',     proteinuria: 'Proteinúria (bielkoviny v moči)',     dyspareunia: 'U žien: dyspareunia, dysmenorea',     varicocele: 'U mužov: ľavostranná varikokéla',     fatigue: 'Únava, ortostatická hypotenzia',   };      const differentialList = {     uti: 'Infekcie močových ciest',     nephritis: 'Nefritída',     stones: 'Obličkové kamene',     endometriosis: 'Endometrióza',     autoimmune: 'Autoimunitné ochorenia',   };    const handleSymptomChange = (e) => {     setSymptoms({ ...symptoms, [e.target.name]: e.target.checked });   };      const handleDifferentialChange = (e) => {     setDifferential({ ...differential, [e.target.name]: e.target.checked });   };    const hasSymptoms = Object.values(symptoms).some(v => v);    const resetAll = () => {     setStep(1);     setSymptoms({ hematuria: false, pain: false, proteinuria: false, dyspareunia: false, varicocele: false, fatigue: false });     setDifferential({ uti: false, nephritis: false, stones: false, endometriosis: false, autoimmune: false });     setDusResults({ diameterRatio: '', velocityRatio: '', distance: '' });     setCtaMraResults({ compression: false, collaterals: false, gonadalDistension: false, angle: '' });     setInvasiveResults({ gradient: '' });     setDiagnosis(null);   };    const generateDiagnosis = () => {     let score = 0;     let findings = [];      // Krok 1: Symptómy     if (hasSymptoms) {         score += 1;         const selectedSymptoms = Object.keys(symptoms).filter(key => symptoms[key]).map(key => symptomList[key]);         findings.push({ title: "Prítomné symptómy", items: selectedSymptoms, positive: true });     } else {          findings.push({ title: "Prítomné symptómy", items: ["Žiadne vybrané symptómy."], positive: false });     }          // Krok 2: Diferenciálna diagnostika     const excludedItems = Object.keys(differential).filter(key => differential[key]).map(key => differentialList[key]);     const notExcludedItems = Object.keys(differential).filter(key => !differential[key]).map(key => differentialList[key]);      if (excludedItems.length > 0) {         findings.push({ title: "Diferenciálna diagnostika: Vylúčené", items: excludedItems, positive: true });     }     if (notExcludedItems.length > 0) {         findings.push({ title: "Diferenciálna diagnostika: Potrebné ešte zvážiť/vylúčiť", items: notExcludedItems, positive: false });     }      // Krok 3: DUS     const dusPositive = parseFloat(dusResults.diameterRatio) > 4 || parseFloat(dusResults.velocityRatio) > 4.2 || (parseFloat(dusResults.distance) > 0 && parseFloat(dusResults.distance) < 10);     if (dusPositive) {         score += 2;         let dusItems = [];         if(parseFloat(dusResults.diameterRatio) > 4) dusItems.push(`Pomer priemeru LRV > 4 (Zadané: ${dusResults.diameterRatio})`);         if(parseFloat(dusResults.velocityRatio) > 4.2) dusItems.push(`Pomer rýchlosti prietoku > 4.2 (Zadané: ${dusResults.velocityRatio})`);         if(parseFloat(dusResults.distance) > 0 && parseFloat(dusResults.distance) < 10) dusItems.push(`Vzdialenosť aorta-AMS < 10 mm (Zadané: ${dusResults.distance})`);         findings.push({ title: "Duplexná Sonografia (DUS)", items: dusItems, positive: true });     } else if (dusResults.diameterRatio || dusResults.velocityRatio || dusResults.distance) {         findings.push({ title: "Duplexná Sonografia (DUS)", items: ["Kritériá na DUS neboli splnené."], positive: false });     }      // Krok 4: CTA/MRA     const ctaMraPositive = ctaMraResults.compression || ctaMraResults.collaterals || ctaMraResults.gonadalDistension || (parseFloat(ctaMraResults.angle) > 0 && parseFloat(ctaMraResults.angle) < 35);     if (ctaMraPositive) {         score += 2;         let ctaItems = [];         if(ctaMraResults.compression) ctaItems.push("Viditeľná kompresia a dilatácia LRV.");         if(ctaMraResults.collaterals) ctaItems.push("Prítomnosť kolaterálnych žíl.");         if(ctaMraResults.gonadalDistension) ctaItems.push("Distenzia gonádnych žíl.");         if(parseFloat(ctaMraResults.angle) > 0 && parseFloat(ctaMraResults.angle) < 35) ctaItems.push(`Uhol aorta-AMS < 35° (Zadané: ${ctaMraResults.angle}°)`);         findings.push({ title: "CTA / MRA", items: ctaItems, positive: true });     } else if (Object.values(ctaMraResults).some(v => v)) {         findings.push({ title: "CTA / MRA", items: ["Na CTA/MRA neboli nájdené žiadne relevantné znaky."], positive: false });     }      // Krok 5: Invazívne potvrdenie (Voliteľné)     const invasivePositive = parseFloat(invasiveResults.gradient) > 2;     if (invasivePositive) {         score += 3; // Najväčšia váha         findings.push({ title: "Invazívne potvrdenie (Venografia/IVUS)", items: [`Tlakový gradient > 2 mmHg (Zadané: ${invasiveResults.gradient} mmHg)`], positive: true });     } else if (invasiveResults.gradient !== '') {          findings.push({ title: "Invazívne potvrdenie (Venografia/IVUS)", items: [`Tlakový gradient ≤ 2 mmHg (Zadané: ${invasiveResults.gradient} mmHg)`], positive: false });     }       let resultText = "";     if (invasivePositive) {         resultText = "Diagnóza Luskáčikovho syndrómu je potvrdená na základe invazívneho merania.";     } else if (score >= 5) {         resultText = "Diagnóza Luskáčikovho syndrómu je vysoko pravdepodobná na základe klinických a rádiologických nálezov.";     } else if (score >= 3) {         resultText = "Podozrenie na Luskáčikov syndróm pretrváva. Zvážte invazívne potvrdenie, ak symptómy pretrvávajú a sú závažné.";     } else {         resultText = "Diagnóza Luskáčikovho syndrómu je málo pravdepodobná na základe poskytnutých informácií.";     }          if (notExcludedItems.length > 0) {         resultText += " Pred stanovením finálnej diagnózy je však kľúčové vylúčiť aj ostatné možné príčiny symptómov.";     }      setDiagnosis({ text: resultText, findings });     setStep(6);   };    const renderStep = () => {     switch (step) {       case 1:         return (           <div className="animate-fade-in">             <h2 className="text-2xl font-bold text-gray-800 mb-2">Krok 1: Klinické Podozrenie a Anamnéza</h2>             <p className="text-gray-600 mb-6">Vyberte prítomné príznaky u pacienta.</p>             <div className="space-y-4">               {Object.entries(symptomList).map(([key, value]) => (                 <label key={key} className="flex items-center p-4 border rounded-lg hover:bg-blue-50 transition-colors">                   <input                     type="checkbox"                     name={key}                     checked={symptoms[key]}                     onChange={handleSymptomChange}                     className="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"                   />                   <span className="ml-4 text-gray-700">{value}</span>                 </label>               ))}             </div>           </div>         );       case 2:         return (           <div className="animate-fade-in">             <h2 className="text-2xl font-bold text-gray-800 mb-2">Krok 2: Vylúčenie Iných Ochorení</h2>             <p className="text-gray-600 mb-6">Označte ochorenia, ktoré už boli u pacienta vylúčené.</p>             <div className="space-y-4">               {Object.entries(differentialList).map(([key, value]) => (                 <label key={key} className="flex items-center p-4 border rounded-lg hover:bg-blue-50 transition-colors">                   <input                     type="checkbox"                     name={key}                     checked={differential[key]}                     onChange={handleDifferentialChange}                     className="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"                   />                   <span className="ml-4 text-gray-700">{value}</span>                 </label>               ))}             </div>           </div>         );       case 3:         return (           <div className="animate-fade-in">             <h2 className="text-2xl font-bold text-gray-800 mb-2">Krok 3: Duplexná Sonografia (DUS)</h2>             <p className="text-gray-600 mb-6">Zadajte namerané hodnoty z DUS vyšetrenia (ak bolo vykonané).</p>             <div className="space-y-4">               <div>                 <label htmlFor="diameterRatio" className="block text-sm font-medium text-gray-700">Pomer priemeru LRV (hílus / aortomezenterický uhol)</label>                 <input                   type="number"                   id="diameterRatio"                   value={dusResults.diameterRatio}                   onChange={(e) => setDusResults({ ...dusResults, diameterRatio: e.target.value })}                   className="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"                   placeholder="Napr. 4.5 (> 4 je signifikantné)"                 />               </div>               <div>                 <label htmlFor="velocityRatio" className="block text-sm font-medium text-gray-700">Pomer vrcholovej rýchlosti prietoku v LRV</label>                 <input                   type="number"                   id="velocityRatio"                   value={dusResults.velocityRatio}                   onChange={(e) => setDusResults({ ...dusResults, velocityRatio: e.target.value })}                   className="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"                   placeholder="Napr. 5.1 (> 4.2-5 je signifikantné)"                 />               </div>               <div>                 <label htmlFor="distance" className="block text-sm font-medium text-gray-700">Vzdialenosť medzi aortou a a. mesenterica sup. (v mm)</label>                 <input                   type="number"                   id="distance"                   value={dusResults.distance}                   onChange={(e) => setDusResults({ ...dusResults, distance: e.target.value })}                   className="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"                   placeholder="Napr. 8 (< 10 mm je signifikantné)"                 />               </div>             </div>           </div>         );       case 4:         return (           <div className="animate-fade-in">             <h2 className="text-2xl font-bold text-gray-800 mb-2">Krok 4: CTA alebo MRA</h2>             <p className="text-gray-600 mb-6">Označte nálezy z CTA/MRA a zadajte nameraný uhol (ak bolo vykonané).</p>             <div className="space-y-4">                 <label className="flex items-center p-3 border rounded-lg hover:bg-blue-50">                     <input type="checkbox" checked={ctaMraResults.compression} onChange={(e) => setCtaMraResults({...ctaMraResults, compression: e.target.checked})} className="h-5 w-5 rounded"/>                     <span className="ml-3">Kompresia a dilatácia LRV</span>                 </label>                 <label className="flex items-center p-3 border rounded-lg hover:bg-blue-50">                     <input type="checkbox" checked={ctaMraResults.collaterals} onChange={(e) => setCtaMraResults({...ctaMraResults, collaterals: e.target.checked})} className="h-5 w-5 rounded"/>                     <span className="ml-3">Prítomnosť kolaterálnych žíl</span>                 </label>                 <label className="flex items-center p-3 border rounded-lg hover:bg-blue-50">                     <input type="checkbox" checked={ctaMraResults.gonadalDistension} onChange={(e) => setCtaMraResults({...ctaMraResults, gonadalDistension: e.target.checked})} className="h-5 w-5 rounded"/>                     <span className="ml-3">Distenzia gonádnych žíl / panvová kongescia</span>                 </label>                  <div>                     <label htmlFor="angle" className="block text-sm font-medium text-gray-700">Uhol medzi aortou a a. mesenterica superior (°)</label>                     <input                       type="number"                       id="angle"                       value={ctaMraResults.angle}                       onChange={(e) => setCtaMraResults({ ...ctaMraResults, angle: e.target.value })}                       className="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"                       placeholder="Napr. 25 (< 35° je signifikantné)"                     />                 </div>             </div>           </div>         );       case 5:         return (           <div className="animate-fade-in">             <h2 className="text-2xl font-bold text-gray-800 mb-2">Krok 5: Invazívne Potvrdenie Diagnózy (Voliteľné)</h2>             <p className="text-gray-600 mb-6">Zadajte tlakový gradient medzi LRV a dolnou dutou žilou.</p>              <div className="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg mb-6">                 <p className="text-sm text-blue-700">Tento krok je potrebný pre definitívne potvrdenie diagnózy, najmä pred plánovanou invazívnou liečbou.</p>             </div>             <div>                 <label htmlFor="gradient" className="block text-sm font-medium text-gray-700">Tlakový gradient (v mmHg)</label>                 <input                   type="number"                   id="gradient"                   value={invasiveResults.gradient}                   onChange={(e) => setInvasiveResults({ ...invasiveResults, gradient: e.target.value })}                   className="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"                   placeholder="Napr. 3 (> 2 mmHg potvrdzuje diagnózu)"                 />             </div>           </div>         );       case 6:         return (             <div className="animate-fade-in">                 <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center">                     <ClipboardListIcon className="h-8 w-8 mr-3 text-blue-600"/>                     Výsledok Algoritmu                 </h2>                 <div className="p-5 rounded-lg bg-gray-100 shadow-inner">                     <p className="text-lg font-semibold text-gray-900">{diagnosis.text}</p>                 </div>                  <h3 className="text-xl font-semibold text-gray-800 mt-6 mb-3">Zhrnutie nálezov:</h3>                 <div className="space-y-3">                     {diagnosis.findings.map((finding, index) => (                         <div key={index} className={`p-4 rounded-lg border-l-4 ${finding.positive ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'}`}>                            <h4 className="font-bold text-gray-800">{finding.title}</h4>                            <ul className="list-disc list-inside mt-2 text-sm text-gray-700">                                {finding.items.map((item, i) => <li key={i}>{item}</li>)}                            </ul>                         </div>                     ))}                 </div>             </div>         );       default:         return null;     }   };    return (     <div className="bg-gray-50 min-h-screen flex items-center justify-center p-4 font-sans">       <div className="w-full max-w-2xl bg-white rounded-2xl shadow-lg p-8 space-y-8">         <div className="text-center">             <h1 className="text-3xl font-bold text-gray-900 flex items-center justify-center">                 <BeakerIcon className="h-8 w-8 mr-3 text-blue-600"/>                 Diagnostický Asistent pre NCS             </h1>             <p className="text-gray-500 mt-2">Podľa usmernení ESVS 2025</p>         </div>          {/* Progress Bar */}         {step <= 5 && (             <div className="w-full bg-gray-200 rounded-full h-2.5">                 <div className="bg-blue-600 h-2.5 rounded-full transition-all duration-500" style={{ width: `${(step - 1) * 20}%` }}></div>             </div>         )}          <div>{renderStep()}</div>          <div className="flex justify-between items-center pt-6 border-t">           {step > 1 && step < 6 && (             <button               onClick={() => setStep(step - 1)}               className="px-6 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"             >               Späť             </button>           )}                      {step < 4 && (             <button               onClick={() => setStep(step + 1)}               disabled={step === 1 && !hasSymptoms}               className="px-6 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed"             >               Ďalej             </button>           )}            {step === 4 && (             <div className="w-full flex flex-col sm:flex-row gap-3">                  <button                     onClick={generateDiagnosis}                     className="w-full px-4 py-2 text-sm font-medium text-green-700 bg-green-100 border border-green-300 rounded-lg hover:bg-green-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"                   >                     Vyhodnotiť bez invazívneho merania                   </button>                  <button                     onClick={() => setStep(5)}                     className="w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"                   >                     Zadať invazívne meranie                   </button>             </div>           )}            {step === 5 && (             <button               onClick={generateDiagnosis}               className="w-full px-6 py-3 text-base font-medium text-white bg-green-600 border border-transparent rounded-lg shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"             >               Vyhodnotiť diagnózu             </button>           )}            {step === 6 && (             <button               onClick={resetAll}               className="w-full px-6 py-3 text-base font-medium text-white bg-blue-600 border border-transparent rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"             >               Začať odznova             </button>           )}         </div>       </div>     </div>   ); } 
